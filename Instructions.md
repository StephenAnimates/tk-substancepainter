# Configurration Instructions
First of all, read [Getting started with configurations](https://help.autodesk.com/view/SGDEV/ENU/?guid=SGD_pg_developer_pg_getting_started_advanced_config_html#differences-between-the-basic-and-default-configurations)

# Setup for tk-config-basic
These instructions show how to setup `tk-substancepainter` when using the `tk-config-basic`

## 1. Download the Engine Code

In your Toolkit pipeline configuration, open the `config/env/includes/engines.yml` file. Add the following block to register the `tk-substancepainter` engine. This tells Toolkit where to download the engine code from.

```yaml
# env/includes/engine.yml

...

# Adobe Substance 3D Painter
engines.tk-substancepainter.location:
  type: git
  path: https://github.com/StephenAnimates/tk-substancepainter.git
  version: v2.0.5
```

**Note:** Always check this repository for the latest release version and update the `version` field accordingly.

When developing or testing the engine, change the `type:` to `git_branch` and add `branch: master` or `branch: develop`. While the documentation indicates that no version is required, this does not appear to work. If you add `version: head` it will pull the latest commit.

In production when released, use the `type: git`, and `version: vX.X.X` and remove the `branch:`. For example:

```yaml
# env/includes/engine.yml

...
engines.tk-substancepainter.location:
  type: git_branch
  branch: master
  path: https://github.com/StephenAnimates/tk-substancepainter
  version: head
```

After adding this, run `tank cache_apps` from your pipeline configuration root to download the engine and its bundled configuration.

## 2. Copy Configuration Files

The Substance 3D Painter integration requires a standard set of Toolkit apps. This repository includes a pre-configured `app_locations.yml` file with all the necessary apps and versions.

1.  **Locate the Downloaded Engine:**
    After running `tank cache_apps`, the engine code will be downloaded into your configuration's `bundle_cache` directory. The exact path will look something like this:
    `<your-pipeline-config>/bundle_cache/git/tk-substancepainter.git/<HASH>/`
    
    **Note:** The `<HASH>` is a unique folder name generated by Toolkit based on the git repository URL. You will need to browse your `bundle_cache/git/` folder to find the correct directory. Inside, you will find the cloned `tk-substancepainter` repository.

2.  **Copy App Locations:**
    Copy the `substancepainter` folder from the downloaded engine's folder into your pipeline configuration's `config/env/includes` directory.

    *   **Source**: `<your-pipeline-config>/bundle_cache/git/<HASH>/config/env/includes/substancepainter/`
    *   **Destination**: `<your-pipeline-config>/config/env/includes/substancepainter/`

    The `substancepainter` folder contains 3 files, `apps.yml`, `asset_step.yml`, and `project.yml`.

3. Open the `config/env/common/apps.yml` file and add (if missing):
    ```yaml
    # config/env/common/apps.yml
    ...
    common.apps.tk-multi-workfiles2.location:
      type: app_store
      name: tk-multi-workfiles2
      version: v0.12.1
    common.apps.tk-multi-breakdown2.location:
      type: app_store
      name: tk-multi-breakdown2
      version: v0.4.4
    common.apps.tk-multi-screeningroom.location:
      type: app_store
      name: tk-multi-screeningroom
      version: v0.4.2
    ```
4.  Open the `config/env/common/engines.yml` file and add (if missing):
    ```yaml
     config/env/common/engines.yml
    ```

## 3. Activate the Engine in Environments
Now, edit your environment files to use the new configurations.

1.  **Update the `asset_step` environment:**
    Open your `config/env/asset_step.yml` file and add the following `includes` and `engines` sections. This tells Toolkit to load the Substance Painter settings and activate the engine in the Asset Step context.

    ```yaml
    # config/env/asset_step.yml
    ...

    includes:
    - ./includes/substancepainter/asset_step.yml

    engines:
      ...
      # Add the Substance 3D Painter engine
      tk-substancepainter: "@substancepainter.asset_step"
    ```

2.  **Update the `project` environment:**
    Do the same for your `config/env/project.yml` file to activate the engine when you are in the main Project context.

    ```yaml
    # config/env/project.yml
    ...

    includes:
    - ./includes/substancepainter/project.yml

    engines:
      ...
      # Add the Substance 3D Painter engine
      tk-substancepainter: "@substancepainter.project"
    ```

# Setup for tk-config-default2
These instructions show how to set up `tk-substancepainter` when using the advanced `tk-config-default2` configuration, which includes full file system management.

Add to shotgrid site `sgtk:descriptor:github_release?organization=StephenAnimates&repository=tk-config-default2-djcad&version=refs/tags/v1.7.6`

In dev:
`sgtk:descriptor:git_branch?branch=develop&version=head&path=https://github.com/StephenAnimates/tk-config-default2-djcad.git`

## 1. Add the Engine to your Configuration

In your Toolkit pipeline configuration, open the `env/includes/engine_locations.yml` file. Add the following block to register the `tk-substancepainter` engine. This tells Toolkit where to download the engine code from.

```yaml
# env/includes/engine_locations.yml

...

# Adobe Substance 3D Painter
tk-substancepainter:
  type: git
  path: https://github.com/StephenAnimates/tk-substancepainter.git
  version: v2.0.5
```

**Note:** Always check this repository for the latest release version and update the `version` field accordingly.

When developing or testing the engine, change the `type:` to `git_branch` and add `branch: master` or `branch: develop`. While the documentation indicates that no version is required, this does not appear to work. If you add `version: head` it will pull the latest commit.

In production when released, use the `type: git`, and `version: vX.X.X` and remove the `branch:`. For example:

```yaml
# env/includes/engine.yml

...
tk-substancepainter:
  type: git_branch
  branch: master
  path: https://github.com/StephenAnimates/tk-substancepainter.git
  version: head
```

After modifications, run `tank cache_apps` from your pipeline configuration root to download the engine and its bundled configuration files.

## 2. Copy Configuration Files

Next, copy the engine configuration into your project's configuration.

1.  **Locate the Downloaded Engine:**
    After running `tank cache_apps`, the engine code will be downloaded into your configuration's `bundle_cache` folder. The exact path will look something like this:
    `<your-pipeline-config>/bundle_cache/git/<HASH>/`
    
    **Note:** When using `type: git`, a `git` folder is created in the `bundle_cache` folder. If you are using the `git_branch` type then the folder will be named `git_branch`. The `<HASH>` is a unique folder name generated by Toolkit based on the git repository URL, it will either be the version number or `head` if you are using the latest commit. You will need to browse your `bundle_cache/git/` folder to find the correct directory.

2.  **Copy App Locations:**
    Copy the `app_locations.yml` file from the downloaded engine's `config` folder into your pipeline configuration's `env/includes` directory.

    *   **Source**: `<your-pipeline-config>/bundle_cache/git/tk-substancepainter.git/<HASH>/config/env/includes/substancepainter`
    *   **Destination**: `<your-pipeline-config>/config/env/includes/substancepainter`

    If you already have an `app_locations.yml` file, merge the contents of the source file into your existing one, ensuring there are no duplicate entries.

3.  **Copy App Settings:**
    Copy the entire `substancepainter` settings folder from the downloaded engine into your pipeline configuration's `env/includes` directory.

    *   **Source**: `<your-pipeline-config>/bundle_cache/git/<HASH>/config/env/includes/substancepainter/`
    *   **Destination**: `<your-pipeline-config>/config/env/includes/substancepainter/`

## 3. Activate the Engine in Environments

Finally, edit your environment files to use the new configurations.

1.  **Update the `asset_step` environment:**
    Open your `config/env/asset_step.yml` file and ensure it includes the settings for Substance Painter and activates the engine.

    ```yaml
    # config/env/asset_step.yml
    includes:
    - ./includes/substancepainter/asset_step.yml

    engines:
      tk-substancepainter: "@substancepainter.asset_step"
    ```

2.  **Update the `project` environment:**
    Do the same for your `config/env/project.yml` file to activate the engine when you are in the main Project context.

    ```yaml
    # config/env/project.yml
    includes:
    - ./includes/substancepainter/project.yml

    engines:
      tk-substancepainter: "@substancepainter.project"
    ```